jQuery( document ).ready( function( $ ) {


  $(".cont-post").hide();
  $(".cont-post-post").fadeIn();

  $(".tipo_cat").on("click", function(e) { // When btn is pressed.

		    e.preventDefault();
		    var catTipo = $(this).data('slug');

		    $(this).parent().parent().find(".tipo_cat").removeClass("active");
			
		    $(".cont-post").hide();

		    $(".cont-post-" + catTipo ).fadeIn(400);
		    
		    $(this).addClass("active");
		    

  });

  $(".tipo_cat").on("click", function(e) { // When btn is pressed.


e.preventDefault();

var cat_tipo = $(this).data('slug');

$.ajax({
type: 'POST',
url: ajaxurl,
crossDomain: true,
dataType: 'html',
data: {
"action": "load-filter",
tipo: cat_tipo
},

afterSend: function() {



},
success: function(data) {
if (data != 0) {
$(".cont-post").html(data);
} else {
$(".cont-post").text("No hay mÃ¡s resultados");
}
},
complete: function(data) {

}
});
});

	//*  Mobile event handler (requires Mobble plugin)
	var eventType = 'click';
	if ( $('.mobile').length > 0 || $('.tablet').length > 0 ) {
		eventType = 'touchstart';
	}

	//* Background parallax effect
	function setParallaxBackgroundPosition( initialSetup ){
		$('.background--parallax, .background--parallax-original').each(function(){
		    var distance = $(this).offset().top;
		    var height = $(this).outerHeight();
		    var scrollPosition = $(window).scrollTop();
		    var windowHeight = $(window).outerHeight();

		    if ( initialSetup == true ) {
		    	$(this).css('background-position', 'center ' + parseInt( -windowHeight/4 ) + 'px');
		    } else {
			    if ( ( scrollPosition + windowHeight/0.25 ) >= distance ) {
			        $(this).css('background-position', 'center ' + parseInt( (scrollPosition - distance) / 2 ) + 'px');
			    }		    	
		    }
	    });
	}
	setParallaxBackgroundPosition(true);
	$(window).on('scroll', function() {
		setParallaxBackgroundPosition();
	});

	//* Toggle Search Form
	/*
	$('.header__primary-menu .btn--search').on( eventType, function(){
		var container = $('.header__primary-menu .lg--flex');
		var formInput = $('.header__primary-menu .form--search .input--text');

		if ( formInput.val() === '' ) {
			if ( !container.hasClass('js-showSearchForm') ) {
				container.addClass('js-showSearchForm');
			} else {
				formInput.addClass('input--error');
			}
			formInput.focus();
			return false;
		} else {
			$(this).closest('form').submit();
		}
	});

	$('body').on( eventType, function(e){
		if ( $(e.target).closest('.header__primary-menu').length == 0 ) {
			$('.header__primary-menu .lg--flex').removeClass('js-showSearchForm');
			$('.header__primary-menu .form--search .input--text').val('').removeClass('input--error');
		}
	});
*/

	$('.header__top-menu .btn--search').on( eventType, function(){
		var container = $('.header__top-menu');
		var formInput = $('.header__top-menu .form--search .input--text');

		if ( formInput.val() === '' ) {
			if ( !container.hasClass('js-showSearchForm') ) {
				container.addClass('js-showSearchForm');
			} else {
				formInput.addClass('input--error');
			}
			formInput.focus();
			return false;
		} else {
			$(this).closest('form').submit();
		}
	});

	$('body').on( eventType, function(e){
		if ( $(e.target).closest('.header__top-menu').length == 0 ) {
			$('.header__top-menu').removeClass('js-showSearchForm');
			$('.header__top-menu .form--search .input--text').val('').removeClass('input--error');
		}
	});

	//* Fixed header
	/*
	var distance = $('.header__primary-menu').offset().top,
    $window = $(window);

	$(window).scroll(function() {
	    if ( $(window).scrollTop() >= distance ) {
	        $('.header__primary-menu').addClass('header--fixed');
	    } else {
	    	$('.header__primary-menu').removeClass('header--fixed');
	    }
	});
*/

	//* Mobile menu accordion menu
	$('#mobileMenu .menu-item-has-children').on( eventType ,function(e){
		e.stopPropagation();
		$(this).children('.sub-menu').slideToggle();
	});

	//* Set card height - Core Competencies
	setCoreCompetenciesCardHeight();
	$(window).resize(function(){
		setCoreCompetenciesCardHeight();
	});

	function setCoreCompetenciesCardHeight(){
		$('.grid--core-competencies').each(function(){
			var cardContentHeight = 0;
			var cardHeaderHeight = 0;
			var countCards = $(this).find('.card').length;
			var i = 1;

			//* Reset card heights
			$(this).find('.card__content').css('height', 'auto');
			$(this).find('.card__header').css('height', 'auto');

			$(this).find('.card').each(function(){
				if ( i <= countCards && i < 5 ) {
					var cardContentOuterHeight = $(this).find('.card__content').outerHeight();
					var cardHeaderOuterHeight = $(this).find('.card__header').outerHeight();

					if ( cardContentOuterHeight > cardContentHeight ) {
						cardContentHeight = cardContentOuterHeight;
					}

					if ( cardHeaderOuterHeight > cardHeaderHeight ) {
						cardHeaderHeight = cardHeaderOuterHeight;
					}

					i++;
				}
			});

			//* reset iterator
			i = 1;

			$(this).find('.card').each(function(){
				if ( i <= countCards && i < 5 ) {
					$(this).find('.card__content').css('height', cardContentHeight);
					$(this).find('.card__header').css('height', cardHeaderHeight);
					
					i++;
				}
			});
		});
	}

	$('.footer__main h3').on('click', function(){
		if ( $(this).parent().hasClass('contact') ) {
			return;
		}

		if ( $(this).next('nav').length ) {
			 $(this).next().slideToggle();
		} else {
			$(this).closest('.grid').find('nav').slideToggle();
		}
	});

	/* Set active top nav */
	var path = window.location.pathname;

	if ( path.indexOf('resources') > -1 || path.indexOf('blog') > -1 ) {
		$('.menu-item-49089').addClass('current_page_ancestor');
	}

	if ( path.indexOf('blog') > -1 ) {
		$('.menu-item-49054').addClass('current-page-parent');
	}
});